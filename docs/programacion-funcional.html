<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Capítulo 9 Programacion Funcional | Introducción a R para Ciencias Sociales. Aplicación practica en la EPH</title>
  <meta name="description" content="Capítulo 9 Programacion Funcional | Introducción a R para Ciencias Sociales. Aplicación practica en la EPH">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Capítulo 9 Programacion Funcional | Introducción a R para Ciencias Sociales. Aplicación practica en la EPH" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 9 Programacion Funcional | Introducción a R para Ciencias Sociales. Aplicación practica en la EPH" />
  
  
  

<meta name="author" content="Pablo Tiscornia - Guido Weksler - Diego Kozlowski - Natsumi Shokida.">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="rmarkdown.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#presentacion"><i class="fa fa-check"></i><b>1.1</b> Presentación</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#objetivos-del-curso"><i class="fa fa-check"></i><b>1.2</b> Objetivos del curso</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#clases-y-contenido"><i class="fa fa-check"></i><b>1.3</b> Clases y contenido</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#librerias-a-instalar"><i class="fa fa-check"></i><b>1.4</b> Librerias a instalar</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html"><i class="fa fa-check"></i><b>2</b> Conceptos Principales de EPH</a><ul>
<li class="chapter" data-level="2.1" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#que-es-la-eph"><i class="fa fa-check"></i><b>2.1</b> ¿Qué es la EPH?</a></li>
<li class="chapter" data-level="2.2" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#traduzcamos"><i class="fa fa-check"></i><b>2.2</b> Traduzcamos</a><ul>
<li class="chapter" data-level="2.2.1" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#objetivos-de-la-eph"><i class="fa fa-check"></i><b>2.2.1</b> Objetivos de la EPH</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#caracteristicas-de-la-eph"><i class="fa fa-check"></i><b>2.3</b> Características de la EPH</a></li>
<li class="chapter" data-level="2.4" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#la-muestra"><i class="fa fa-check"></i><b>2.4</b> La Muestra</a><ul>
<li class="chapter" data-level="2.4.1" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#principales-tematicas-abordadas-por-la-eph"><i class="fa fa-check"></i><b>2.4.1</b> Principales temáticas abordadas por la EPH</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#instrumento-de-medicion-el-medio-hacia-la-operacionalizacion-de-los-objetivos"><i class="fa fa-check"></i><b>2.5</b> Instrumento de medición: El medio hacia la operacionalización de los objetivos</a></li>
<li class="chapter" data-level="2.6" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#tres-cuestionarios"><i class="fa fa-check"></i><b>2.6</b> Tres cuestionarios</a><ul>
<li class="chapter" data-level="2.6.1" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#cuestionario-de-vivienda"><i class="fa fa-check"></i><b>2.6.1</b> Cuestionario de vivienda</a></li>
<li class="chapter" data-level="2.6.2" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#cuestionario-de-hogar"><i class="fa fa-check"></i><b>2.6.2</b> Cuestionario de hogar</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#marco-analitico-y-tematico-de-la-eph"><i class="fa fa-check"></i><b>2.7</b> Marco analítico y temático de la EPH</a><ul>
<li class="chapter" data-level="2.7.1" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#cuestionario-de-individuos"><i class="fa fa-check"></i><b>2.7.1</b> Cuestionario de individuos</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#cuestinario-individual-principales-indicadores"><i class="fa fa-check"></i><b>2.8</b> Cuestinario individual: Principales indicadores</a></li>
<li class="chapter" data-level="2.9" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#caracterizacion-de-la-poblacion-ocupada"><i class="fa fa-check"></i><b>2.9</b> Caracterización de la población ocupada</a><ul>
<li class="chapter" data-level="2.9.1" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#otros-indicadores-para-describir-a-la-poblacion-ocupada"><i class="fa fa-check"></i><b>2.9.1</b> Otros indicadores para describir a la población ocupada</a></li>
<li class="chapter" data-level="2.9.2" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#caracterizacion-de-la-poblacion-desocupada"><i class="fa fa-check"></i><b>2.9.2</b> Caracterízación de la población desocupada</a></li>
<li class="chapter" data-level="2.9.3" data-path="conceptos-principales-de-eph.html"><a href="conceptos-principales-de-eph.html#clasificadores-utilizados-en-la-eph-rama-de-actividad-y-tarea-ocupacion"><i class="fa fa-check"></i><b>2.9.3</b> Clasificadores utilizados en la EPH (Rama de actividad y Tarea / Ocupación)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html"><i class="fa fa-check"></i><b>3</b> Introducción a R</a><ul>
<li class="chapter" data-level="3.0.1" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#que-es-r"><i class="fa fa-check"></i><b>3.0.1</b> ¿Que es R?</a></li>
<li class="chapter" data-level="3.0.2" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#diferencias-con-stata-y-spss"><i class="fa fa-check"></i><b>3.0.2</b> Diferencias con STATA y SPSS</a></li>
<li class="chapter" data-level="3.1" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#logica-sintactica."><i class="fa fa-check"></i><b>3.1</b> Lógica sintáctica.</a><ul>
<li class="chapter" data-level="3.1.1" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#definicion-de-objetos"><i class="fa fa-check"></i><b>3.1.1</b> Definición de objetos</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#r-base"><i class="fa fa-check"></i><b>3.1.2</b> R base</a></li>
<li class="chapter" data-level="3.1.3" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#data-frames"><i class="fa fa-check"></i><b>3.1.3</b> Data Frames</a></li>
<li class="chapter" data-level="3.1.4" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#listas"><i class="fa fa-check"></i><b>3.1.4</b> Listas</a></li>
<li class="chapter" data-level="3.1.5" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#instalacion-de-paquetes-complementarios-al-r-base"><i class="fa fa-check"></i><b>3.1.5</b> Instalación de paquetes complementarios al R Base</a></li>
<li class="chapter" data-level="3.1.6" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#lectura-y-escritura-de-archivos"><i class="fa fa-check"></i><b>3.1.6</b> Lectura y escritura de archivos</a></li>
<li class="chapter" data-level="3.1.7" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#ambientes-de-trabajo"><i class="fa fa-check"></i><b>3.1.7</b> Ambientes de trabajo</a></li>
<li class="chapter" data-level="3.1.8" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#paquetes-a-utilizar-a-lo-largo-del-curso"><i class="fa fa-check"></i><b>3.1.8</b> Paquetes a utilizar a lo largo del curso:</a></li>
<li class="chapter" data-level="3.1.9" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#ejercicios-para-practicar"><i class="fa fa-check"></i><b>3.1.9</b> Ejercicios para practicar</a></li>
<li class="chapter" data-level="3.1.10" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#ejercicios-de-tarea"><i class="fa fa-check"></i><b>3.1.10</b> Ejercicios de tarea</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><i class="fa fa-check"></i><b>4</b> Tidyverse y Tasas básicas del Mercado de Trabajo</a><ul>
<li class="chapter" data-level="4.1" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#estructuracion-de-bases-de-datos"><i class="fa fa-check"></i><b>4.1</b> Estructuración de Bases de Datos</a></li>
<li class="chapter" data-level="4.2" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#dplyr"><i class="fa fa-check"></i><b>4.2</b> Dplyr</a><ul>
<li class="chapter" data-level="4.2.1" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#filter"><i class="fa fa-check"></i><b>4.2.1</b> filter</a></li>
<li class="chapter" data-level="4.2.2" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#rename"><i class="fa fa-check"></i><b>4.2.2</b> rename</a></li>
<li class="chapter" data-level="4.2.3" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#mutate"><i class="fa fa-check"></i><b>4.2.3</b> mutate</a></li>
<li class="chapter" data-level="4.2.4" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#case_when"><i class="fa fa-check"></i><b>4.2.4</b> case_when</a></li>
<li class="chapter" data-level="4.2.5" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#select"><i class="fa fa-check"></i><b>4.2.5</b> select</a></li>
<li class="chapter" data-level="4.2.6" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#arrange"><i class="fa fa-check"></i><b>4.2.6</b> arrange</a></li>
<li class="chapter" data-level="4.2.7" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#summarise"><i class="fa fa-check"></i><b>4.2.7</b> summarise</a></li>
<li class="chapter" data-level="4.2.8" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#group_by"><i class="fa fa-check"></i><b>4.2.8</b> group_by</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#joins"><i class="fa fa-check"></i><b>4.3</b> Joins</a><ul>
<li class="chapter" data-level="4.3.1" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#left_join"><i class="fa fa-check"></i><b>4.3.1</b> left_join</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#tidyr"><i class="fa fa-check"></i><b>4.4</b> Tidyr</a><ul>
<li class="chapter" data-level="4.4.1" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#gather-y-spread"><i class="fa fa-check"></i><b>4.4.1</b> Gather y Spread</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#tasas-del-mercado-de-trabajo"><i class="fa fa-check"></i><b>4.5</b> Tasas del Mercado de Trabajo</a><ul>
<li class="chapter" data-level="4.5.1" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#tasa-de-empleo"><i class="fa fa-check"></i><b>4.5.1</b> Tasa de Empleo</a></li>
<li class="chapter" data-level="4.5.2" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#tasas-basicas---total-aglomerados"><i class="fa fa-check"></i><b>4.5.2</b> Tásas Básicas - Total Aglomerados</a></li>
<li class="chapter" data-level="4.5.3" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#tasas-basicas-por-aglomerado"><i class="fa fa-check"></i><b>4.5.3</b> Tásas Básicas por Aglomerado</a></li>
<li class="chapter" data-level="4.5.4" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#ejercicio-para-2-trimestres"><i class="fa fa-check"></i><b>4.5.4</b> Ejercicio para 2 trimestres</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#ejercicios-para-practicar-1"><i class="fa fa-check"></i><b>4.6</b> Ejercicios para practicar</a><ul>
<li class="chapter" data-level="4.6.1" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#ejercicios-de-tarea-1"><i class="fa fa-check"></i><b>4.6.1</b> Ejercicios de tarea</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="calculo-de-pobreza-por-linea.html"><a href="calculo-de-pobreza-por-linea.html"><i class="fa fa-check"></i><b>5</b> Cálculo de Pobreza por Línea</a><ul>
<li class="chapter" data-level="5.1" data-path="calculo-de-pobreza-por-linea.html"><a href="calculo-de-pobreza-por-linea.html#canastas-trimestrales-por-region"><i class="fa fa-check"></i><b>5.1</b> Canastas Trimestrales por Region</a></li>
<li class="chapter" data-level="5.2" data-path="calculo-de-pobreza-por-linea.html"><a href="calculo-de-pobreza-por-linea.html#unidades-de-adulto-equivalente-por-hogar-en-la-base-individual"><i class="fa fa-check"></i><b>5.2</b> Unidades de Adulto Equivalente por hogar en la base Individual</a></li>
<li class="chapter" data-level="5.3" data-path="calculo-de-pobreza-por-linea.html"><a href="calculo-de-pobreza-por-linea.html#calculo-de-tasas-de-pobreza-e-indigencia"><i class="fa fa-check"></i><b>5.3</b> Cálculo de Tasas de Pobreza e Indigencia</a></li>
<li class="chapter" data-level="5.4" data-path="introduccion-a-r.html"><a href="introduccion-a-r.html#ejercicios-para-practicar"><i class="fa fa-check"></i><b>5.4</b> Ejercicios Para prácticar</a></li>
<li class="chapter" data-level="5.5" data-path="calculo-de-pobreza-por-linea.html"><a href="calculo-de-pobreza-por-linea.html#ejercicios-de-tarea-2"><i class="fa fa-check"></i><b>5.5</b> Ejercicios de tarea</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html"><i class="fa fa-check"></i><b>6</b> Gráficos y Distribución del Ingreso</a><ul>
<li class="chapter" data-level="6.1" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#graficos-basicos-en-r"><i class="fa fa-check"></i><b>6.1</b> Gráficos Básicos en R</a><ul>
<li class="chapter" data-level="6.1.1" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#png"><i class="fa fa-check"></i><b>6.1.1</b> png</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#ggplot2"><i class="fa fa-check"></i><b>6.2</b> <span>Ggplot2</span></a><ul>
<li class="chapter" data-level="6.2.1" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#grafico-de-puntos"><i class="fa fa-check"></i><b>6.2.1</b> Gráfico de Puntos</a></li>
<li class="chapter" data-level="6.2.2" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#extensiones-de-ggplot."><i class="fa fa-check"></i><b>6.2.2</b> Extensiones de <span>GGplot</span>.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#graficos-ingresos---eph"><i class="fa fa-check"></i><b>6.3</b> Graficos Ingresos - EPH</a><ul>
<li class="chapter" data-level="6.3.1" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#ingreso-de-la-ocupacion-principal"><i class="fa fa-check"></i><b>6.3.1</b> Ingreso de la ocupación principal</a></li>
<li class="chapter" data-level="6.3.2" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#distribucion-de-los-ingresos-laborales-y-no-laborales-por-sexo"><i class="fa fa-check"></i><b>6.3.2</b> Distribución de los ingresos laborales y no laborales por sexo</a></li>
<li class="chapter" data-level="6.3.3" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#otros-graficos"><i class="fa fa-check"></i><b>6.3.3</b> Otros gráficos</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#ejercicios"><i class="fa fa-check"></i><b>6.4</b> Ejercicios</a><ul>
<li class="chapter" data-level="6.4.1" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#para-practicar"><i class="fa fa-check"></i><b>6.4.1</b> Para practicar</a></li>
<li class="chapter" data-level="6.4.2" data-path="graficos-y-distribucion-del-ingreso.html"><a href="graficos-y-distribucion-del-ingreso.html#de-tarea"><i class="fa fa-check"></i><b>6.4.2</b> De tarea</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pool-de-datos-en-panel-y-matrices-de-transicion.html"><a href="pool-de-datos-en-panel-y-matrices-de-transicion.html"><i class="fa fa-check"></i><b>7</b> Pool de Datos en Panel y Matrices de Transición</a><ul>
<li class="chapter" data-level="7.1" data-path="pool-de-datos-en-panel-y-matrices-de-transicion.html"><a href="pool-de-datos-en-panel-y-matrices-de-transicion.html#datos-de-panel"><i class="fa fa-check"></i><b>7.1</b> Datos De Panel</a><ul>
<li class="chapter" data-level="7.1.1" data-path="pool-de-datos-en-panel-y-matrices-de-transicion.html"><a href="pool-de-datos-en-panel-y-matrices-de-transicion.html#introduccion-1"><i class="fa fa-check"></i><b>7.1.1</b> Introducción</a></li>
<li class="chapter" data-level="7.1.2" data-path="pool-de-datos-en-panel-y-matrices-de-transicion.html"><a href="pool-de-datos-en-panel-y-matrices-de-transicion.html#pasos-para-la-construccion-del-panel"><i class="fa fa-check"></i><b>7.1.2</b> Pasos para la construccion del Panel</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="pool-de-datos-en-panel-y-matrices-de-transicion.html"><a href="pool-de-datos-en-panel-y-matrices-de-transicion.html#matrices-de-transicion"><i class="fa fa-check"></i><b>7.2</b> Matrices de transición</a><ul>
<li class="chapter" data-level="7.2.1" data-path="pool-de-datos-en-panel-y-matrices-de-transicion.html"><a href="pool-de-datos-en-panel-y-matrices-de-transicion.html#calculo-de-probabilidades-de-transicion."><i class="fa fa-check"></i><b>7.2.1</b> Calculo de probabilidades de transición.</a></li>
<li class="chapter" data-level="7.2.2" data-path="pool-de-datos-en-panel-y-matrices-de-transicion.html"><a href="pool-de-datos-en-panel-y-matrices-de-transicion.html#grafico-de-matriz-de-transicion"><i class="fa fa-check"></i><b>7.2.2</b> Gráfico de Matriz de Transición</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html"><a href="tidyverse-y-tasas-basicas-del-mercado-de-trabajo.html#ejercicios-para-practicar-1"><i class="fa fa-check"></i><b>7.3</b> Ejercicios Para prácticar</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>8</b> RMarkdown</a><ul>
<li class="chapter" data-level="8.1" data-path="rmarkdown.html"><a href="rmarkdown.html#introduccion-2"><i class="fa fa-check"></i><b>8.1</b> Introducción</a></li>
<li class="chapter" data-level="8.2" data-path="rmarkdown.html"><a href="rmarkdown.html#organizacion-de-los-datos"><i class="fa fa-check"></i><b>8.2</b> Organización de los datos</a></li>
<li class="chapter" data-level="8.3" data-path="rmarkdown.html"><a href="rmarkdown.html#tasas-basicas-de-mercado-de-trabajo"><i class="fa fa-check"></i><b>8.3</b> Tasas básicas de Mercado de trabajo</a></li>
<li class="chapter" data-level="8.4" data-path="rmarkdown.html"><a href="rmarkdown.html#empleo-no-registrado"><i class="fa fa-check"></i><b>8.4</b> Empleo no registrado</a></li>
<li class="chapter" data-level="8.5" data-path="rmarkdown.html"><a href="rmarkdown.html#brechas-de-ingresos"><i class="fa fa-check"></i><b>8.5</b> Brechas de ingresos</a><ul>
<li class="chapter" data-level="8.5.1" data-path="rmarkdown.html"><a href="rmarkdown.html#brecha-de-ingresos-totales-mensuales"><i class="fa fa-check"></i><b>8.5.1</b> Brecha de ingresos totales mensuales</a></li>
<li class="chapter" data-level="8.5.2" data-path="rmarkdown.html"><a href="rmarkdown.html#brecha-de-ingresos-mensuales-por-nivel-educativo"><i class="fa fa-check"></i><b>8.5.2</b> Brecha de ingresos mensuales por nivel educativo</a></li>
<li class="chapter" data-level="8.5.3" data-path="rmarkdown.html"><a href="rmarkdown.html#brecha-de-ingresos-mensuales-y-horarios-por-nivel-educativo"><i class="fa fa-check"></i><b>8.5.3</b> Brecha de ingresos mensuales y horarios por nivel educativo</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="rmarkdown.html"><a href="rmarkdown.html#horas-semanales-trabajadas"><i class="fa fa-check"></i><b>8.6</b> Horas semanales trabajadas</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="programacion-funcional.html"><a href="programacion-funcional.html"><i class="fa fa-check"></i><b>9</b> Programacion Funcional</a><ul>
<li class="chapter" data-level="9.1" data-path="programacion-funcional.html"><a href="programacion-funcional.html#loops"><i class="fa fa-check"></i><b>9.1</b> Loops</a></li>
<li class="chapter" data-level="9.2" data-path="programacion-funcional.html"><a href="programacion-funcional.html#estructuras-condicionales"><i class="fa fa-check"></i><b>9.2</b> Estructuras Condicionales</a><ul>
<li class="chapter" data-level="9.2.1" data-path="programacion-funcional.html"><a href="programacion-funcional.html#if"><i class="fa fa-check"></i><b>9.2.1</b> if</a></li>
<li class="chapter" data-level="9.2.2" data-path="programacion-funcional.html"><a href="programacion-funcional.html#ifelse"><i class="fa fa-check"></i><b>9.2.2</b> ifelse</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="programacion-funcional.html"><a href="programacion-funcional.html#funciones-1"><i class="fa fa-check"></i><b>9.3</b> Funciones</a></li>
<li class="chapter" data-level="9.4" data-path="programacion-funcional.html"><a href="programacion-funcional.html#purrr"><i class="fa fa-check"></i><b>9.4</b> PURRR</a><ul>
<li class="chapter" data-level="9.4.1" data-path="programacion-funcional.html"><a href="programacion-funcional.html#iterando-en-la-eph"><i class="fa fa-check"></i><b>9.4.1</b> Iterando en la EPH</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="programacion-funcional.html"><a href="programacion-funcional.html#ejemplo.-regresion-lineal"><i class="fa fa-check"></i><b>9.5</b> Ejemplo. Regresión lineal</a><ul>
<li class="chapter" data-level="9.5.1" data-path="programacion-funcional.html"><a href="programacion-funcional.html#loopeando"><i class="fa fa-check"></i><b>9.5.1</b> Loopeando</a></li>
<li class="chapter" data-level="9.5.2" data-path="programacion-funcional.html"><a href="programacion-funcional.html#usando-map"><i class="fa fa-check"></i><b>9.5.2</b> Usando MAP</a></li>
<li class="chapter" data-level="9.5.3" data-path="programacion-funcional.html"><a href="programacion-funcional.html#walk"><i class="fa fa-check"></i><b>9.5.3</b> Walk</a></li>
<li class="chapter" data-level="9.5.4" data-path="programacion-funcional.html"><a href="programacion-funcional.html#discusion."><i class="fa fa-check"></i><b>9.5.4</b> Discusión.</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="programacion-funcional.html"><a href="programacion-funcional.html#lectura-y-escritura-de-archivos-intermedia"><i class="fa fa-check"></i><b>9.6</b> Lectura y escritura de archivos intermedia</a><ul>
<li class="chapter" data-level="9.6.1" data-path="programacion-funcional.html"><a href="programacion-funcional.html#rdata"><i class="fa fa-check"></i><b>9.6.1</b> RData</a></li>
<li class="chapter" data-level="9.6.2" data-path="programacion-funcional.html"><a href="programacion-funcional.html#rds"><i class="fa fa-check"></i><b>9.6.2</b> RDS</a></li>
<li class="chapter" data-level="9.6.3" data-path="programacion-funcional.html"><a href="programacion-funcional.html#spss-stata-sas"><i class="fa fa-check"></i><b>9.6.3</b> SPSS, STATA, SAS</a></li>
<li class="chapter" data-level="9.6.4" data-path="programacion-funcional.html"><a href="programacion-funcional.html#encoding"><i class="fa fa-check"></i><b>9.6.4</b> Encoding</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="programacion-funcional.html"><a href="programacion-funcional.html#ayudas"><i class="fa fa-check"></i><b>9.7</b> Ayudas</a></li>
<li class="chapter" data-level="9.8" data-path="programacion-funcional.html"><a href="programacion-funcional.html#ejercicios-para-practicar-2"><i class="fa fa-check"></i><b>9.8</b> Ejercicios para practicar</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introducción a R para Ciencias Sociales. Aplicación practica en la EPH</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="programacion-funcional" class="section level1">
<h1><span class="header-section-number">Capítulo 9</span> Programacion Funcional</h1>
<blockquote>
<p>Reiniciar R</p>
</blockquote>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(openxlsx)
<span class="kw">library</span>(ggthemes)
<span class="kw">library</span>(fs)</code></pre>
<div id="loops" class="section level2">
<h2><span class="header-section-number">9.1</span> Loops</h2>
<p>Un <strong>loop</strong> es una estructura de código que nos permite aplicar iterativamente un mismo conjunto de comandos, variando el valor de una variable. Por ejemplo:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){
   <span class="kw">print</span>(i<span class="op">^</span><span class="dv">2</span>)
}</code></pre>
<pre><code>## [1] 1
## [1] 4
## [1] 9
## [1] 16
## [1] 25
## [1] 36
## [1] 49
## [1] 64
## [1] 81
## [1] 100</code></pre>
<p>Esto se lee como : “Recorre cada uno de los valores (i) del vector numérico 1 a 10, y para cada uno de ellos imprimí el cuadrado (i^2)”.<br />
Uno puede especificar la palabra que desee que tomé cada uno de los valores que debe tomar. En el ejemplo anterior fue <strong>i</strong>, pero bien podría ser la “<strong>Valores</strong>”</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span>(Valores <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){
   <span class="kw">print</span>(Valores<span class="op">^</span><span class="dv">2</span>)
  
}</code></pre>
<pre><code>## [1] 1
## [1] 4
## [1] 9
## [1] 16
## [1] 25
## [1] 36
## [1] 49
## [1] 64
## [1] 81
## [1] 100</code></pre>
<p>Un loop puede iterar sobre cualquier tipo de vector, independientemente de lo que contenga.</p>
<blockquote>
<p>Los loops son una estructura básica que existen en cualquier lenguaje de programación. En R no recomendamos abusar de ellos porque hacen que el código sea más lento.</p>
</blockquote>
</div>
<div id="estructuras-condicionales" class="section level2">
<h2><span class="header-section-number">9.2</span> Estructuras Condicionales</h2>
<p>Las <strong>estructuras condiconales</strong> nos permiten ejecutar una porción de código en caso de que cumplan una condición lógica</p>
<div id="if" class="section level3">
<h3><span class="header-section-number">9.2.1</span> if</h3>
<p>Su funcionamiento es el siguiente:<br />
<code>if(condicion){codigo a ejecutar si se cumple la condición}</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>( <span class="dv">2</span><span class="op">+</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="dv">4</span>){
  <span class="kw">print</span>(<span class="st">&quot;Menos Mal&quot;</span>)
}</code></pre>
<pre><code>## [1] &quot;Menos Mal&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>( <span class="dv">2</span><span class="op">+</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="fl">148.24</span>){
  <span class="kw">print</span>(<span class="st">&quot;R, tenemos un problema&quot;</span>)
}</code></pre>
</div>
<div id="ifelse" class="section level3">
<h3><span class="header-section-number">9.2.2</span> ifelse</h3>
<p>La función <code>if_else()</code> sirve para crear o modificar dicotómicamente un objeto/variable/vector a partir del cumplimiento de una o más condiciones lógicas.<br />
Su funcionamiento es el siguiente:<br />
<code>if_else(condicion,función a aplicar si se cumple la condición,función a aplicar si no se cumple la condición)</code></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">if_else</span>(<span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">==</span><span class="dv">4</span>, <span class="dt">true =</span> <span class="st">&quot;Joya&quot;</span>,<span class="dt">false =</span> <span class="st">&quot;Error&quot;</span>)</code></pre>
<pre><code>## [1] &quot;Joya&quot;</code></pre>
</div>
</div>
<div id="funciones-1" class="section level2">
<h2><span class="header-section-number">9.3</span> Funciones</h2>
<p>La creación de <strong>funciones</strong> propias nos permite automatizar todas aquellas partes del código que se repiten mucho. Una vez diseñadas, funcionan igual que cualquier comando.</p>
<p>Por ejemplo, podemos definir la suma de dos elementos como</p>
<pre class="sourceCode r"><code class="sourceCode r">suma &lt;-<span class="st"> </span><span class="cf">function</span>(valor1, valor2) {
  valor1<span class="op">+</span>valor2
}

<span class="kw">suma</span>(<span class="dv">5</span>,<span class="dv">6</span>)</code></pre>
<pre><code>## [1] 11</code></pre>
<p>Obviamente las funciones no son sólo para variables numéricas. Por ejemplo, podemos pegar dos strings con una flecha en el medio</p>
<pre class="sourceCode r"><code class="sourceCode r">funcion_prueba &lt;-<span class="st"> </span><span class="cf">function</span>(parametro1,parametro2) {
  <span class="kw">paste</span>(parametro1, parametro2, <span class="dt">sep =</span> <span class="st">&quot; &lt;--&gt; &quot;</span>)
}

<span class="kw">funcion_prueba</span>(<span class="dt">parametro1 =</span> <span class="st">&quot;A ver&quot;</span>, <span class="dt">parametro2 =</span> <span class="st">&quot;Que pasa&quot;</span>)</code></pre>
<pre><code>## [1] &quot;A ver &lt;--&gt; Que pasa&quot;</code></pre>
<p>También podemos asignar un valor por default para los parametros en caso de que el usuario no defina su valor al utilizar la función.</p>
<pre class="sourceCode r"><code class="sourceCode r">Otra_funcion_prueba &lt;-<span class="st"> </span><span class="cf">function</span>(parametro1 ,<span class="dt">parametro2 =</span> <span class="st">&quot;String default&quot;</span>) {
  <span class="kw">paste</span>(parametro1, parametro2, <span class="dt">sep =</span> <span class="st">&quot; &lt;--&gt; &quot;</span>)
  
}
<span class="kw">Otra_funcion_prueba</span>(<span class="dt">parametro1 =</span> <span class="st">&quot;Valor 1 &quot;</span>)</code></pre>
<pre><code>## [1] &quot;Valor 1  &lt;--&gt; String default&quot;</code></pre>
<p>Las funciones que creamos nosotros permanecen en el ambiente de R temporariamente. Cuando removemos los objetos del ambiente, la función deja de existir. Por ende, debemos incorporarla en cada uno de los scripts en la cual la necesitemos. Una buena práctica, es incorporar nuestras funciones útiles al comienzo de cada script junto a la carga de las librerías.</p>
<p>Vale mencionar que <strong>lo que ocurre en una función, queda en la función</strong> excepto que explícitamente pidamos que devuelva el resultado, con el comando <code>print()</code>.</p>
<p>Las funciones siempre devuelven el último objeto que se crea en ellas, o si explicitamente se utiliza el comando <code>return()</code></p>
</div>
<div id="purrr" class="section level2">
<h2><span class="header-section-number">9.4</span> PURRR<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></h2>
<p>MAP es la forma <em>tidy</em> de hacer loops. Además de ser más prolijo el código, es mucho más eficiente.</p>
<p>La función <strong>map</strong> toma un input, una función para aplicar, y alguna otra cosa (por ejemplo parametros que necesite la función)</p>
<ul>
<li>map(.x, .f, …)</li>
<li>map(VECTOR_O_LIST_INPUT, FUNCTION_A_APLICAR, OTROS_OPCIONALES)</li>
</ul>
<p>Usamos <strong>map2</strong> cuando tenemos que pasar dos input, que se aplican sobre una función:</p>
<ul>
<li>map2(.x, .y, .f, …)</li>
<li>map2(INPUT_UNO, INPUT_DOS, FUNCTION_A_APLICAR, OTROS_OPCIONALES)</li>
</ul>
<p>Si tenemos más de dos…</p>
<ul>
<li>pmap(.l, .f, …)</li>
<li>pmap(VECTOR_O_LIST_INPUT, FUNCTION_A_APLICAR, OTROS_OPCIONALES)</li>
</ul>
<p>Por ejemplo. Si queremos utilizar la función prueba sobre los datos del dataframe ABC_123</p>
<pre class="sourceCode r"><code class="sourceCode r">ABC_<span class="dv">123</span> &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Letras =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>],<span class="dt">Num =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>)
funcion_prueba</code></pre>
<pre><code>## function(parametro1,parametro2) {
##   paste(parametro1, parametro2, sep = &quot; &lt;--&gt; &quot;)
## }</code></pre>
<p>Si el resultado que queremos es que junte cada fila, necesitamos pasarle dos parámetros: utilizamos <code>map2()</code></p>
<pre class="sourceCode r"><code class="sourceCode r">resultado &lt;-<span class="st"> </span><span class="kw">map2</span>(ABC_<span class="dv">123</span><span class="op">$</span>Letras,ABC_<span class="dv">123</span><span class="op">$</span>Num,funcion_prueba)
resultado[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</code></pre>
<pre><code>## [[1]]
## [1] &quot;A &lt;--&gt; 1&quot;
## 
## [[2]]
## [1] &quot;B &lt;--&gt; 2&quot;
## 
## [[3]]
## [1] &quot;C &lt;--&gt; 3&quot;</code></pre>
<p>La salida de los <code>map()</code> es una <strong>lista</strong>, no un vector, por lo que si lo metemos dentro de un dataframe se vería así:</p>
<pre class="sourceCode r"><code class="sourceCode r">ABC_<span class="dv">123</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">resultado=</span> <span class="kw">map2</span>(Letras,Num,funcion_prueba))</code></pre>
<pre><code>##    Letras Num resultado
## 1       A   1  A &lt;--&gt; 1
## 2       B   2  B &lt;--&gt; 2
## 3       C   3  C &lt;--&gt; 3
## 4       D   4  D &lt;--&gt; 4
## 5       E   5  E &lt;--&gt; 5
## 6       F   6  F &lt;--&gt; 6
## 7       G   7  G &lt;--&gt; 7
## 8       H   8  H &lt;--&gt; 8
## 9       I   9  I &lt;--&gt; 9
## 10      J  10 J &lt;--&gt; 10
## 11      K  11 K &lt;--&gt; 11
## 12      L  12 L &lt;--&gt; 12
## 13      M  13 M &lt;--&gt; 13
## 14      N  14 N &lt;--&gt; 14
## 15      O  15 O &lt;--&gt; 15
## 16      P  16 P &lt;--&gt; 16
## 17      Q  17 Q &lt;--&gt; 17
## 18      R  18 R &lt;--&gt; 18
## 19      S  19 S &lt;--&gt; 19
## 20      T  20 T &lt;--&gt; 20</code></pre>
<p>al ponerlo dentro del dataframe desarma la lista y guarda cada elemento por separado.
La magia de eso es que podemos <strong>guardar cualquier cosa en el dataframe</strong> no sólo valores, sino también listas, funciones, dataframes, etc.</p>
<p>Si queremos recuperar los valores originales en este caso podemos usar <code>unlist()</code></p>
<pre class="sourceCode r"><code class="sourceCode r">resultado[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unlist</span>()</code></pre>
<pre><code>## [1] &quot;A &lt;--&gt; 1&quot; &quot;B &lt;--&gt; 2&quot; &quot;C &lt;--&gt; 3&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">ABC_<span class="dv">123</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">resultado=</span> <span class="kw">unlist</span>(<span class="kw">map2</span>(Letras,Num,funcion_prueba)))</code></pre>
<pre><code>##    Letras Num resultado
## 1       A   1  A &lt;--&gt; 1
## 2       B   2  B &lt;--&gt; 2
## 3       C   3  C &lt;--&gt; 3
## 4       D   4  D &lt;--&gt; 4
## 5       E   5  E &lt;--&gt; 5
## 6       F   6  F &lt;--&gt; 6
## 7       G   7  G &lt;--&gt; 7
## 8       H   8  H &lt;--&gt; 8
## 9       I   9  I &lt;--&gt; 9
## 10      J  10 J &lt;--&gt; 10
## 11      K  11 K &lt;--&gt; 11
## 12      L  12 L &lt;--&gt; 12
## 13      M  13 M &lt;--&gt; 13
## 14      N  14 N &lt;--&gt; 14
## 15      O  15 O &lt;--&gt; 15
## 16      P  16 P &lt;--&gt; 16
## 17      Q  17 Q &lt;--&gt; 17
## 18      R  18 R &lt;--&gt; 18
## 19      S  19 S &lt;--&gt; 19
## 20      T  20 T &lt;--&gt; 20</code></pre>
<p>Si lo que queríamos era que la función nos haga todas las combinaciones de letras y número, entonces lo que necesitamos es pasarle el segúndo parametro como algo <em>fijo</em>, poniendolo después de la función.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map</span>(ABC_<span class="dv">123</span><span class="op">$</span>Letras,funcion_prueba,ABC_<span class="dv">123</span><span class="op">$</span>Num)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</code></pre>
<pre><code>## [[1]]
##  [1] &quot;A &lt;--&gt; 1&quot;  &quot;A &lt;--&gt; 2&quot;  &quot;A &lt;--&gt; 3&quot;  &quot;A &lt;--&gt; 4&quot;  &quot;A &lt;--&gt; 5&quot; 
##  [6] &quot;A &lt;--&gt; 6&quot;  &quot;A &lt;--&gt; 7&quot;  &quot;A &lt;--&gt; 8&quot;  &quot;A &lt;--&gt; 9&quot;  &quot;A &lt;--&gt; 10&quot;
## [11] &quot;A &lt;--&gt; 11&quot; &quot;A &lt;--&gt; 12&quot; &quot;A &lt;--&gt; 13&quot; &quot;A &lt;--&gt; 14&quot; &quot;A &lt;--&gt; 15&quot;
## [16] &quot;A &lt;--&gt; 16&quot; &quot;A &lt;--&gt; 17&quot; &quot;A &lt;--&gt; 18&quot; &quot;A &lt;--&gt; 19&quot; &quot;A &lt;--&gt; 20&quot;
## 
## [[2]]
##  [1] &quot;B &lt;--&gt; 1&quot;  &quot;B &lt;--&gt; 2&quot;  &quot;B &lt;--&gt; 3&quot;  &quot;B &lt;--&gt; 4&quot;  &quot;B &lt;--&gt; 5&quot; 
##  [6] &quot;B &lt;--&gt; 6&quot;  &quot;B &lt;--&gt; 7&quot;  &quot;B &lt;--&gt; 8&quot;  &quot;B &lt;--&gt; 9&quot;  &quot;B &lt;--&gt; 10&quot;
## [11] &quot;B &lt;--&gt; 11&quot; &quot;B &lt;--&gt; 12&quot; &quot;B &lt;--&gt; 13&quot; &quot;B &lt;--&gt; 14&quot; &quot;B &lt;--&gt; 15&quot;
## [16] &quot;B &lt;--&gt; 16&quot; &quot;B &lt;--&gt; 17&quot; &quot;B &lt;--&gt; 18&quot; &quot;B &lt;--&gt; 19&quot; &quot;B &lt;--&gt; 20&quot;</code></pre>
<p>En este caso, el map itera sobre cada elemento de <code>letras</code>, y para cada elemento <em>i</em> hace
<code>funcion_prueba(i,ABC$Num)</code> y guarda el resultado en la lista</p>
<p>si lo queremos meter en el dataframe</p>
<pre class="sourceCode r"><code class="sourceCode r">ABC_<span class="dv">123</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">resultado=</span> <span class="kw">map</span>(Letras,funcion_prueba,Num))</code></pre>
<pre><code>##    Letras Num
## 1       A   1
## 2       B   2
## 3       C   3
## 4       D   4
## 5       E   5
## 6       F   6
## 7       G   7
## 8       H   8
## 9       I   9
## 10      J  10
## 11      K  11
## 12      L  12
## 13      M  13
## 14      N  14
## 15      O  15
## 16      P  16
## 17      Q  17
## 18      R  18
## 19      S  19
## 20      T  20
##                                                                                                                                                                                                            resultado
## 1  A &lt;--&gt; 1, A &lt;--&gt; 2, A &lt;--&gt; 3, A &lt;--&gt; 4, A &lt;--&gt; 5, A &lt;--&gt; 6, A &lt;--&gt; 7, A &lt;--&gt; 8, A &lt;--&gt; 9, A &lt;--&gt; 10, A &lt;--&gt; 11, A &lt;--&gt; 12, A &lt;--&gt; 13, A &lt;--&gt; 14, A &lt;--&gt; 15, A &lt;--&gt; 16, A &lt;--&gt; 17, A &lt;--&gt; 18, A &lt;--&gt; 19, A &lt;--&gt; 20
## 2  B &lt;--&gt; 1, B &lt;--&gt; 2, B &lt;--&gt; 3, B &lt;--&gt; 4, B &lt;--&gt; 5, B &lt;--&gt; 6, B &lt;--&gt; 7, B &lt;--&gt; 8, B &lt;--&gt; 9, B &lt;--&gt; 10, B &lt;--&gt; 11, B &lt;--&gt; 12, B &lt;--&gt; 13, B &lt;--&gt; 14, B &lt;--&gt; 15, B &lt;--&gt; 16, B &lt;--&gt; 17, B &lt;--&gt; 18, B &lt;--&gt; 19, B &lt;--&gt; 20
## 3  C &lt;--&gt; 1, C &lt;--&gt; 2, C &lt;--&gt; 3, C &lt;--&gt; 4, C &lt;--&gt; 5, C &lt;--&gt; 6, C &lt;--&gt; 7, C &lt;--&gt; 8, C &lt;--&gt; 9, C &lt;--&gt; 10, C &lt;--&gt; 11, C &lt;--&gt; 12, C &lt;--&gt; 13, C &lt;--&gt; 14, C &lt;--&gt; 15, C &lt;--&gt; 16, C &lt;--&gt; 17, C &lt;--&gt; 18, C &lt;--&gt; 19, C &lt;--&gt; 20
## 4  D &lt;--&gt; 1, D &lt;--&gt; 2, D &lt;--&gt; 3, D &lt;--&gt; 4, D &lt;--&gt; 5, D &lt;--&gt; 6, D &lt;--&gt; 7, D &lt;--&gt; 8, D &lt;--&gt; 9, D &lt;--&gt; 10, D &lt;--&gt; 11, D &lt;--&gt; 12, D &lt;--&gt; 13, D &lt;--&gt; 14, D &lt;--&gt; 15, D &lt;--&gt; 16, D &lt;--&gt; 17, D &lt;--&gt; 18, D &lt;--&gt; 19, D &lt;--&gt; 20
## 5  E &lt;--&gt; 1, E &lt;--&gt; 2, E &lt;--&gt; 3, E &lt;--&gt; 4, E &lt;--&gt; 5, E &lt;--&gt; 6, E &lt;--&gt; 7, E &lt;--&gt; 8, E &lt;--&gt; 9, E &lt;--&gt; 10, E &lt;--&gt; 11, E &lt;--&gt; 12, E &lt;--&gt; 13, E &lt;--&gt; 14, E &lt;--&gt; 15, E &lt;--&gt; 16, E &lt;--&gt; 17, E &lt;--&gt; 18, E &lt;--&gt; 19, E &lt;--&gt; 20
## 6  F &lt;--&gt; 1, F &lt;--&gt; 2, F &lt;--&gt; 3, F &lt;--&gt; 4, F &lt;--&gt; 5, F &lt;--&gt; 6, F &lt;--&gt; 7, F &lt;--&gt; 8, F &lt;--&gt; 9, F &lt;--&gt; 10, F &lt;--&gt; 11, F &lt;--&gt; 12, F &lt;--&gt; 13, F &lt;--&gt; 14, F &lt;--&gt; 15, F &lt;--&gt; 16, F &lt;--&gt; 17, F &lt;--&gt; 18, F &lt;--&gt; 19, F &lt;--&gt; 20
## 7  G &lt;--&gt; 1, G &lt;--&gt; 2, G &lt;--&gt; 3, G &lt;--&gt; 4, G &lt;--&gt; 5, G &lt;--&gt; 6, G &lt;--&gt; 7, G &lt;--&gt; 8, G &lt;--&gt; 9, G &lt;--&gt; 10, G &lt;--&gt; 11, G &lt;--&gt; 12, G &lt;--&gt; 13, G &lt;--&gt; 14, G &lt;--&gt; 15, G &lt;--&gt; 16, G &lt;--&gt; 17, G &lt;--&gt; 18, G &lt;--&gt; 19, G &lt;--&gt; 20
## 8  H &lt;--&gt; 1, H &lt;--&gt; 2, H &lt;--&gt; 3, H &lt;--&gt; 4, H &lt;--&gt; 5, H &lt;--&gt; 6, H &lt;--&gt; 7, H &lt;--&gt; 8, H &lt;--&gt; 9, H &lt;--&gt; 10, H &lt;--&gt; 11, H &lt;--&gt; 12, H &lt;--&gt; 13, H &lt;--&gt; 14, H &lt;--&gt; 15, H &lt;--&gt; 16, H &lt;--&gt; 17, H &lt;--&gt; 18, H &lt;--&gt; 19, H &lt;--&gt; 20
## 9  I &lt;--&gt; 1, I &lt;--&gt; 2, I &lt;--&gt; 3, I &lt;--&gt; 4, I &lt;--&gt; 5, I &lt;--&gt; 6, I &lt;--&gt; 7, I &lt;--&gt; 8, I &lt;--&gt; 9, I &lt;--&gt; 10, I &lt;--&gt; 11, I &lt;--&gt; 12, I &lt;--&gt; 13, I &lt;--&gt; 14, I &lt;--&gt; 15, I &lt;--&gt; 16, I &lt;--&gt; 17, I &lt;--&gt; 18, I &lt;--&gt; 19, I &lt;--&gt; 20
## 10 J &lt;--&gt; 1, J &lt;--&gt; 2, J &lt;--&gt; 3, J &lt;--&gt; 4, J &lt;--&gt; 5, J &lt;--&gt; 6, J &lt;--&gt; 7, J &lt;--&gt; 8, J &lt;--&gt; 9, J &lt;--&gt; 10, J &lt;--&gt; 11, J &lt;--&gt; 12, J &lt;--&gt; 13, J &lt;--&gt; 14, J &lt;--&gt; 15, J &lt;--&gt; 16, J &lt;--&gt; 17, J &lt;--&gt; 18, J &lt;--&gt; 19, J &lt;--&gt; 20
## 11 K &lt;--&gt; 1, K &lt;--&gt; 2, K &lt;--&gt; 3, K &lt;--&gt; 4, K &lt;--&gt; 5, K &lt;--&gt; 6, K &lt;--&gt; 7, K &lt;--&gt; 8, K &lt;--&gt; 9, K &lt;--&gt; 10, K &lt;--&gt; 11, K &lt;--&gt; 12, K &lt;--&gt; 13, K &lt;--&gt; 14, K &lt;--&gt; 15, K &lt;--&gt; 16, K &lt;--&gt; 17, K &lt;--&gt; 18, K &lt;--&gt; 19, K &lt;--&gt; 20
## 12 L &lt;--&gt; 1, L &lt;--&gt; 2, L &lt;--&gt; 3, L &lt;--&gt; 4, L &lt;--&gt; 5, L &lt;--&gt; 6, L &lt;--&gt; 7, L &lt;--&gt; 8, L &lt;--&gt; 9, L &lt;--&gt; 10, L &lt;--&gt; 11, L &lt;--&gt; 12, L &lt;--&gt; 13, L &lt;--&gt; 14, L &lt;--&gt; 15, L &lt;--&gt; 16, L &lt;--&gt; 17, L &lt;--&gt; 18, L &lt;--&gt; 19, L &lt;--&gt; 20
## 13 M &lt;--&gt; 1, M &lt;--&gt; 2, M &lt;--&gt; 3, M &lt;--&gt; 4, M &lt;--&gt; 5, M &lt;--&gt; 6, M &lt;--&gt; 7, M &lt;--&gt; 8, M &lt;--&gt; 9, M &lt;--&gt; 10, M &lt;--&gt; 11, M &lt;--&gt; 12, M &lt;--&gt; 13, M &lt;--&gt; 14, M &lt;--&gt; 15, M &lt;--&gt; 16, M &lt;--&gt; 17, M &lt;--&gt; 18, M &lt;--&gt; 19, M &lt;--&gt; 20
## 14 N &lt;--&gt; 1, N &lt;--&gt; 2, N &lt;--&gt; 3, N &lt;--&gt; 4, N &lt;--&gt; 5, N &lt;--&gt; 6, N &lt;--&gt; 7, N &lt;--&gt; 8, N &lt;--&gt; 9, N &lt;--&gt; 10, N &lt;--&gt; 11, N &lt;--&gt; 12, N &lt;--&gt; 13, N &lt;--&gt; 14, N &lt;--&gt; 15, N &lt;--&gt; 16, N &lt;--&gt; 17, N &lt;--&gt; 18, N &lt;--&gt; 19, N &lt;--&gt; 20
## 15 O &lt;--&gt; 1, O &lt;--&gt; 2, O &lt;--&gt; 3, O &lt;--&gt; 4, O &lt;--&gt; 5, O &lt;--&gt; 6, O &lt;--&gt; 7, O &lt;--&gt; 8, O &lt;--&gt; 9, O &lt;--&gt; 10, O &lt;--&gt; 11, O &lt;--&gt; 12, O &lt;--&gt; 13, O &lt;--&gt; 14, O &lt;--&gt; 15, O &lt;--&gt; 16, O &lt;--&gt; 17, O &lt;--&gt; 18, O &lt;--&gt; 19, O &lt;--&gt; 20
## 16 P &lt;--&gt; 1, P &lt;--&gt; 2, P &lt;--&gt; 3, P &lt;--&gt; 4, P &lt;--&gt; 5, P &lt;--&gt; 6, P &lt;--&gt; 7, P &lt;--&gt; 8, P &lt;--&gt; 9, P &lt;--&gt; 10, P &lt;--&gt; 11, P &lt;--&gt; 12, P &lt;--&gt; 13, P &lt;--&gt; 14, P &lt;--&gt; 15, P &lt;--&gt; 16, P &lt;--&gt; 17, P &lt;--&gt; 18, P &lt;--&gt; 19, P &lt;--&gt; 20
## 17 Q &lt;--&gt; 1, Q &lt;--&gt; 2, Q &lt;--&gt; 3, Q &lt;--&gt; 4, Q &lt;--&gt; 5, Q &lt;--&gt; 6, Q &lt;--&gt; 7, Q &lt;--&gt; 8, Q &lt;--&gt; 9, Q &lt;--&gt; 10, Q &lt;--&gt; 11, Q &lt;--&gt; 12, Q &lt;--&gt; 13, Q &lt;--&gt; 14, Q &lt;--&gt; 15, Q &lt;--&gt; 16, Q &lt;--&gt; 17, Q &lt;--&gt; 18, Q &lt;--&gt; 19, Q &lt;--&gt; 20
## 18 R &lt;--&gt; 1, R &lt;--&gt; 2, R &lt;--&gt; 3, R &lt;--&gt; 4, R &lt;--&gt; 5, R &lt;--&gt; 6, R &lt;--&gt; 7, R &lt;--&gt; 8, R &lt;--&gt; 9, R &lt;--&gt; 10, R &lt;--&gt; 11, R &lt;--&gt; 12, R &lt;--&gt; 13, R &lt;--&gt; 14, R &lt;--&gt; 15, R &lt;--&gt; 16, R &lt;--&gt; 17, R &lt;--&gt; 18, R &lt;--&gt; 19, R &lt;--&gt; 20
## 19 S &lt;--&gt; 1, S &lt;--&gt; 2, S &lt;--&gt; 3, S &lt;--&gt; 4, S &lt;--&gt; 5, S &lt;--&gt; 6, S &lt;--&gt; 7, S &lt;--&gt; 8, S &lt;--&gt; 9, S &lt;--&gt; 10, S &lt;--&gt; 11, S &lt;--&gt; 12, S &lt;--&gt; 13, S &lt;--&gt; 14, S &lt;--&gt; 15, S &lt;--&gt; 16, S &lt;--&gt; 17, S &lt;--&gt; 18, S &lt;--&gt; 19, S &lt;--&gt; 20
## 20 T &lt;--&gt; 1, T &lt;--&gt; 2, T &lt;--&gt; 3, T &lt;--&gt; 4, T &lt;--&gt; 5, T &lt;--&gt; 6, T &lt;--&gt; 7, T &lt;--&gt; 8, T &lt;--&gt; 9, T &lt;--&gt; 10, T &lt;--&gt; 11, T &lt;--&gt; 12, T &lt;--&gt; 13, T &lt;--&gt; 14, T &lt;--&gt; 15, T &lt;--&gt; 16, T &lt;--&gt; 17, T &lt;--&gt; 18, T &lt;--&gt; 19, T &lt;--&gt; 20</code></pre>
<p>Ahora cada fila tiene un vector de 20 elementos guardado en la columna resultado</p>
<div id="iterando-en-la-eph" class="section level3">
<h3><span class="header-section-number">9.4.1</span> Iterando en la EPH</h3>
<p>Lo primero que necesitamos es definir un vector o lista sobre el que iterar.</p>
<p>Por ejemplo, podemos armar un vector con los path a las bases individuales, con el comando <code>fs::dir_ls</code></p>
<pre class="sourceCode r"><code class="sourceCode r">bases_individuales_path &lt;-<span class="st"> </span><span class="kw">dir_ls</span>(<span class="dt">path =</span> <span class="st">&#39;Fuentes/&#39;</span>, <span class="dt">regexp=</span> <span class="st">&#39;individual&#39;</span>)
bases_individuales_path</code></pre>
<pre><code>## Fuentes/usu_individual_t117.txt Fuentes/usu_individual_t216.txt 
## Fuentes/usu_individual_t316.txt Fuentes/usu_individual_t416.txt</code></pre>
<p>Luego, como en la función que usamos para leer las bases definimos muchos parametros, nos podemos armar una función <em>wrapper</em> que sólo necesite un parámetro, y que simplifique la escritura del map</p>
<pre class="sourceCode r"><code class="sourceCode r">leer_base_eph &lt;-<span class="st"> </span><span class="cf">function</span>(path) {
  <span class="kw">read.table</span>(path,<span class="dt">sep=</span><span class="st">&quot;;&quot;</span>, <span class="dt">dec=</span><span class="st">&quot;,&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">fill =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">select</span>(ANO4,TRIMESTRE,REGION,P21,CH04, CH06)
}

bases_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(bases_individuales_path) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">base =</span> <span class="kw">map</span>(bases_individuales_path, leer_base_eph))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">bases_df</code></pre>
<pre><code>## # A tibble: 4 x 2
##   bases_individuales_path         base                 
##   &lt;fs::path&gt;                      &lt;list&gt;               
## 1 Fuentes/usu_individual_t117.txt &lt;df[,6] [58,675 × 6]&gt;
## 2 Fuentes/usu_individual_t216.txt &lt;df[,6] [59,811 × 6]&gt;
## 3 Fuentes/usu_individual_t316.txt &lt;df[,6] [59,550 × 6]&gt;
## 4 Fuentes/usu_individual_t416.txt &lt;df[,6] [58,154 × 6]&gt;</code></pre>
<p>El resultado es un DF donde la columna <strong>base</strong> tiene en cada fila, otro DF con la base de la EPH de ese período. Esto es lo que llamamos un <em>nested DF</em> o dataframe nesteado pa les pibes.</p>
<p>Si queremos juntar todo, podemos usar <code>unnest()</code></p>
<pre class="sourceCode r"><code class="sourceCode r">bases_df &lt;-<span class="st"> </span>bases_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unnest</span>()
bases_df[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre>
<pre><code>## # A tibble: 10 x 7
##    bases_individuales_path          ANO4 TRIMESTRE REGION   P21  CH04  CH06
##    &lt;fs::path&gt;                      &lt;int&gt;     &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1 Fuentes/usu_individual_t117.txt  2017         1     43     0     2    18
##  2 Fuentes/usu_individual_t117.txt  2017         1     43     0     2    13
##  3 Fuentes/usu_individual_t117.txt  2017         1     43     0     1    15
##  4 Fuentes/usu_individual_t117.txt  2017         1     43     0     2    11
##  5 Fuentes/usu_individual_t117.txt  2017         1     43     0     1     7
##  6 Fuentes/usu_individual_t117.txt  2017         1     43     0     2     4
##  7 Fuentes/usu_individual_t117.txt  2017         1     43     0     2    17
##  8 Fuentes/usu_individual_t117.txt  2017         1     43     0     1     1
##  9 Fuentes/usu_individual_t117.txt  2017         1     43  1500     1    20
## 10 Fuentes/usu_individual_t117.txt  2017         1     43     0     2     1</code></pre>
<blockquote>
<p>¿Qué pasa si los DF que tenemos nesteados no tienen la misma cantidad de columnas?</p>
</blockquote>
<p>Esto mismo lo podemos usar para fragmentar el datastet por alguna variable, con el <code>group_by()</code></p>
<pre class="sourceCode r"><code class="sourceCode r">bases_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(REGION) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">nest</span>()</code></pre>
<pre><code>## # A tibble: 6 x 2
##   REGION data                 
##    &lt;int&gt; &lt;list&gt;               
## 1     43 &lt;tibble [68,274 × 6]&gt;
## 2     41 &lt;tibble [23,302 × 6]&gt;
## 3     44 &lt;tibble [29,033 × 6]&gt;
## 4     42 &lt;tibble [21,997 × 6]&gt;
## 5     40 &lt;tibble [49,560 × 6]&gt;
## 6      1 &lt;tibble [44,024 × 6]&gt;</code></pre>
<p>Así, para cada región tenemos un DF.</p>
<blockquote>
<p>¿ De qué sirve todo esto?</p>
</blockquote>
<p>No todo en la vida es un Dataframe. Hay estucturas de datos que no se pueden normalizar a filas y columnas. En esos casos recurríamos tradicionalmente a los loops. Con MAP podemos tener los elementos agrupados en un sólo objeto y aún conservar sus formas diferentes.</p>
</div>
</div>
<div id="ejemplo.-regresion-lineal" class="section level2">
<h2><span class="header-section-number">9.5</span> Ejemplo. Regresión lineal</h2>
<p>Si bien no nos vamos a meter en el detalle del modelo lineal, es útil usarlo como ejemplo de lo que podemos hacer con MAP.</p>
<p>Planteamos el modelo
<span class="math display">\[
P21 = \beta_0 + \beta_1*CH04 + \beta_2*CH06
\]</span>
Osea, un modleo que explica el ingreso según sexo y edad</p>
<pre class="sourceCode r"><code class="sourceCode r">lmfit &lt;-<span class="st"> </span><span class="kw">lm</span>(P21<span class="op">~</span><span class="kw">factor</span>(CH04)<span class="op">+</span>CH06,<span class="dt">data =</span> bases_df)

<span class="kw">summary</span>(lmfit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = P21 ~ factor(CH04) + CH06, data = bases_df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -8449  -3631  -1938    705 393616 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    2599.1101    29.0732   89.40   &lt;2e-16 ***
## factor(CH04)2 -2250.9637    28.3026  -79.53   &lt;2e-16 ***
## CH06             57.3490     0.6347   90.35   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6858 on 236187 degrees of freedom
## Multiple R-squared:  0.05449,    Adjusted R-squared:  0.05448 
## F-statistic:  6805 on 2 and 236187 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>(al final de la clase podemos charlar sobre los resultados, si hay interés :-) )</p>
<p>De forma Tidy, la librería <code>broom</code> nos da los resultados en un DF.</p>
<pre class="sourceCode r"><code class="sourceCode r">broom<span class="op">::</span><span class="kw">tidy</span>(lmfit)</code></pre>
<pre><code>## # A tibble: 3 x 5
##   term          estimate std.error statistic p.value
##   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)     2599.     29.1        89.4       0
## 2 factor(CH04)2  -2251.     28.3       -79.5       0
## 3 CH06              57.3     0.635      90.4       0</code></pre>
<p>Si lo queremos hacer por region</p>
<div id="loopeando" class="section level3">
<h3><span class="header-section-number">9.5.1</span> Loopeando</h3>
<pre class="sourceCode r"><code class="sourceCode r">resultados &lt;-<span class="st"> </span><span class="kw">tibble</span>()

<span class="cf">for</span> (region <span class="cf">in</span> <span class="kw">unique</span>(bases_df<span class="op">$</span>REGION)) {
  
  data &lt;-<span class="st"> </span>bases_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">filter</span>(REGION<span class="op">==</span>region)
  
  lmfit &lt;-<span class="st"> </span><span class="kw">lm</span>(P21<span class="op">~</span><span class="kw">factor</span>(CH04)<span class="op">+</span>CH06,<span class="dt">data =</span> data)
  
  lmtidy &lt;-<span class="st"> </span>broom<span class="op">::</span><span class="kw">tidy</span>(lmfit)
  lmtidy<span class="op">$</span>region &lt;-<span class="st"> </span>region
  resultados &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(resultados,lmtidy)

}

resultados[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,]</code></pre>
<pre><code>## # A tibble: 10 x 6
##    term          estimate std.error statistic   p.value region
##    &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;  &lt;int&gt;
##  1 (Intercept)     2665.      50.2       53.1 0.            43
##  2 factor(CH04)2  -2045.      48.6      -42.1 0.            43
##  3 CH06              41.6      1.06      39.0 0.            43
##  4 (Intercept)     1808.      69.2       26.1 2.37e-148     41
##  5 factor(CH04)2  -1808.      67.6      -26.8 2.70e-155     41
##  6 CH06              55.6      1.58      35.2 7.99e-265     41
##  7 (Intercept)     3726.     115.        32.3 4.35e-225     44
##  8 factor(CH04)2  -3337.     112.       -29.8 1.23e-192     44
##  9 CH06              93.4      2.58      36.2 3.12e-280     44
## 10 (Intercept)     2674.      81.7       32.7 1.28e-229     42</code></pre>
</div>
<div id="usando-map" class="section level3">
<h3><span class="header-section-number">9.5.2</span> Usando MAP</h3>
<p>Primero me armo una funcion que me simplifica el codigo</p>
<pre class="sourceCode r"><code class="sourceCode r">fun&lt;-<span class="cf">function</span>(porcion,grupo) {  broom<span class="op">::</span><span class="kw">tidy</span>(<span class="kw">lm</span>(P21<span class="op">~</span><span class="kw">factor</span>(CH04)<span class="op">+</span>CH06,<span class="dt">data =</span> porcion))}</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">bases_df_lm &lt;-<span class="st"> </span>bases_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(REGION) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lm =</span> <span class="kw">map</span>(data,fun))
bases_df_lm</code></pre>
<pre><code>## # A tibble: 6 x 3
##   REGION data                  lm              
##    &lt;int&gt; &lt;list&gt;                &lt;list&gt;          
## 1     43 &lt;tibble [68,274 × 6]&gt; &lt;tibble [3 × 5]&gt;
## 2     41 &lt;tibble [23,302 × 6]&gt; &lt;tibble [3 × 5]&gt;
## 3     44 &lt;tibble [29,033 × 6]&gt; &lt;tibble [3 × 5]&gt;
## 4     42 &lt;tibble [21,997 × 6]&gt; &lt;tibble [3 × 5]&gt;
## 5     40 &lt;tibble [49,560 × 6]&gt; &lt;tibble [3 × 5]&gt;
## 6      1 &lt;tibble [44,024 × 6]&gt; &lt;tibble [3 × 5]&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">bases_df_lm <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">unnest</span>(lm) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">10</span>)</code></pre>
<pre><code>## Selecting by p.value</code></pre>
<pre><code>## # A tibble: 10 x 6
##    REGION term          estimate std.error statistic   p.value
##     &lt;int&gt; &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1     41 (Intercept)     1808.      69.2       26.1 2.37e-148
##  2     41 factor(CH04)2  -1808.      67.6      -26.8 2.70e-155
##  3     44 (Intercept)     3726.     115.        32.3 4.35e-225
##  4     44 factor(CH04)2  -3337.     112.       -29.8 1.23e-192
##  5     42 (Intercept)     2674.      81.7       32.7 1.28e-229
##  6     42 factor(CH04)2  -2250.      79.7      -28.2 1.98e-172
##  7     42 CH06              52.0      1.75      29.7 2.70e-190
##  8     40 (Intercept)     1758.      51.3       34.3 2.09e-254
##  9      1 factor(CH04)2  -2411.      74.3      -32.4 3.61e-228
## 10      1 CH06              53.1      1.62      32.7 3.34e-232</code></pre>
<p>O incluso más facil, utilizando <code>group_modify</code> (que es un atajo que solo acepta DF)</p>
<pre class="sourceCode r"><code class="sourceCode r">bases_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(REGION) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_modify</span>(fun) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">10</span>)</code></pre>
<pre><code>## Selecting by p.value</code></pre>
<pre><code>## # A tibble: 18 x 6
## # Groups:   REGION [6]
##    REGION term          estimate std.error statistic   p.value
##     &lt;int&gt; &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1      1 (Intercept)     2993.      77.0       38.9 0.       
##  2      1 factor(CH04)2  -2411.      74.3      -32.4 3.61e-228
##  3      1 CH06              53.1      1.62      32.7 3.34e-232
##  4     40 (Intercept)     1758.      51.3       34.3 2.09e-254
##  5     40 factor(CH04)2  -1924.      50.5      -38.1 1.58e-313
##  6     40 CH06              68.6      1.18      58.1 0.       
##  7     41 (Intercept)     1808.      69.2       26.1 2.37e-148
##  8     41 factor(CH04)2  -1808.      67.6      -26.8 2.70e-155
##  9     41 CH06              55.6      1.58      35.2 7.99e-265
## 10     42 (Intercept)     2674.      81.7       32.7 1.28e-229
## 11     42 factor(CH04)2  -2250.      79.7      -28.2 1.98e-172
## 12     42 CH06              52.0      1.75      29.7 2.70e-190
## 13     43 (Intercept)     2665.      50.2       53.1 0.       
## 14     43 factor(CH04)2  -2045.      48.6      -42.1 0.       
## 15     43 CH06              41.6      1.06      39.0 0.       
## 16     44 (Intercept)     3726.     115.        32.3 4.35e-225
## 17     44 factor(CH04)2  -3337.     112.       -29.8 1.23e-192
## 18     44 CH06              93.4      2.58      36.2 3.12e-280</code></pre>
<p>Pero MAP sirve para operar con cualquier objeto de R.</p>
<p>Por ejemplo podemos guardar el <strong>objeto</strong> <code>S3:lm</code> que es la regresion lineal entrenada. Ese objeto no es ni un vector, ni una lista, ni un DF. No es una estructura de datos, sino que es algo distinto, con <em>propiedades</em> como <code>predict()</code> para predecir, el <code>summary()</code> que vimos, etc.</p>
<pre class="sourceCode r"><code class="sourceCode r">fun&lt;-<span class="cf">function</span>(porcion,grupo) {  <span class="kw">lm</span>(P21<span class="op">~</span><span class="kw">factor</span>(CH04)<span class="op">+</span>CH06,<span class="dt">data =</span> porcion)}

bases_df <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(REGION) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">nest</span>() <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lm =</span> <span class="kw">map</span>(data,fun))</code></pre>
<pre><code>## # A tibble: 6 x 3
##   REGION data                  lm    
##    &lt;int&gt; &lt;list&gt;                &lt;list&gt;
## 1     43 &lt;tibble [68,274 × 6]&gt; &lt;lm&gt;  
## 2     41 &lt;tibble [23,302 × 6]&gt; &lt;lm&gt;  
## 3     44 &lt;tibble [29,033 × 6]&gt; &lt;lm&gt;  
## 4     42 &lt;tibble [21,997 × 6]&gt; &lt;lm&gt;  
## 5     40 &lt;tibble [49,560 × 6]&gt; &lt;lm&gt;  
## 6      1 &lt;tibble [44,024 × 6]&gt; &lt;lm&gt;</code></pre>
</div>
<div id="walk" class="section level3">
<h3><span class="header-section-number">9.5.3</span> Walk</h3>
<p>Las funciones <code>Walk</code> Tienen la misma forma que los <code>map</code>, pero se usan cuando lo que queremos iterar no genera una salida, sino que nos interesan los efectos secundarios que generan.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map2</span>(ABC_<span class="dv">123</span><span class="op">$</span>Letras,ABC_<span class="dv">123</span><span class="op">$</span>Num,funcion_prueba)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</code></pre>
<pre><code>## [[1]]
## [1] &quot;A &lt;--&gt; 1&quot;
## 
## [[2]]
## [1] &quot;B &lt;--&gt; 2&quot;
## 
## [[3]]
## [1] &quot;C &lt;--&gt; 3&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">walk2</span>(ABC_<span class="dv">123</span><span class="op">$</span>Letras,ABC_<span class="dv">123</span><span class="op">$</span>Num,funcion_prueba)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">imprimir_salida &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){
  <span class="kw">print</span>(<span class="kw">funcion_prueba</span>(x,y))
}

<span class="kw">walk2</span>(ABC_<span class="dv">123</span><span class="op">$</span>Letras,ABC_<span class="dv">123</span><span class="op">$</span>Num,imprimir_salida)</code></pre>
<pre><code>## [1] &quot;A &lt;--&gt; 1&quot;
## [1] &quot;B &lt;--&gt; 2&quot;
## [1] &quot;C &lt;--&gt; 3&quot;
## [1] &quot;D &lt;--&gt; 4&quot;
## [1] &quot;E &lt;--&gt; 5&quot;
## [1] &quot;F &lt;--&gt; 6&quot;
## [1] &quot;G &lt;--&gt; 7&quot;
## [1] &quot;H &lt;--&gt; 8&quot;
## [1] &quot;I &lt;--&gt; 9&quot;
## [1] &quot;J &lt;--&gt; 10&quot;
## [1] &quot;K &lt;--&gt; 11&quot;
## [1] &quot;L &lt;--&gt; 12&quot;
## [1] &quot;M &lt;--&gt; 13&quot;
## [1] &quot;N &lt;--&gt; 14&quot;
## [1] &quot;O &lt;--&gt; 15&quot;
## [1] &quot;P &lt;--&gt; 16&quot;
## [1] &quot;Q &lt;--&gt; 17&quot;
## [1] &quot;R &lt;--&gt; 18&quot;
## [1] &quot;S &lt;--&gt; 19&quot;
## [1] &quot;T &lt;--&gt; 20&quot;</code></pre>
<p>Eso que vemos es el efecto secundario dentro de la función (imprimir)</p>
</div>
<div id="discusion." class="section level3">
<h3><span class="header-section-number">9.5.4</span> Discusión.</h3>
<blockquote>
<p>Cuando usar estas herramientas?</p>
</blockquote>
<p>A lo largo del curso vimos diferentes técnicas para manipulación de datos. En particular, la librería dplyr nos permitía fácilmente modificar y crear nuevas variables, agrupando. Cuando usamos <code>dplyr</code> y cuando usamos <code>purrr</code>.</p>
<ul>
<li>Si trabajamos sobre un DF simple, sin variables anidadas (lo que conocíamos hasta hoy) podemos usar <code>dplyr</code></li>
<li><p>Si queremos trabajar con DF anidados, con cosas que no son DF, o si el resultado de la operación que vamos a realizar a nivel file es algo distinto a un valor único, nos conviene usar <code>map</code> y <code>purrr</code></p></li>
<li><p>Las funciones <code>walk</code> son útiles por ejemplo para escribir archivos en disco de forma iterativa. Algo que no genera una salida</p></li>
</ul>
</div>
</div>
<div id="lectura-y-escritura-de-archivos-intermedia" class="section level2">
<h2><span class="header-section-number">9.6</span> Lectura y escritura de archivos intermedia</h2>
<p>R tiene formatos de archivos propios:</p>
<ul>
<li>Rdata</li>
<li>RDS</li>
</ul>
<div id="rdata" class="section level3">
<h3><span class="header-section-number">9.6.1</span> RData</h3>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">15</span>
y &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="ot">TRUE</span>, <span class="dt">c =</span> <span class="st">&quot;oops&quot;</span>)

<span class="co">#Para guardar</span>
<span class="kw">save</span>(x, y, <span class="dt">file =</span> <span class="st">&quot;xy.RData&quot;</span>)

<span class="co">#Para leer</span>
<span class="kw">load</span>(<span class="st">&#39;xy.RData&#39;</span>)</code></pre>
<p>Los archivos de tipo <strong>RData</strong> permiten grabar una <em>imagen</em> de todos los objetos R que querramos.</p>
</div>
<div id="rds" class="section level3">
<h3><span class="header-section-number">9.6.2</span> RDS</h3>
<pre class="sourceCode r"><code class="sourceCode r">x</code></pre>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">saveRDS</span>(x, <span class="st">&quot;x.RDS&quot;</span>)

Z &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;x.RDS&quot;</span>)
Z</code></pre>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15</code></pre>
<p>Los archivos de tipo <strong>RDS</strong> no guardan el nombre del objeto, por lo que podemos nombrarlos cuando los cargamos (aconsejable)</p>
</div>
<div id="spss-stata-sas" class="section level3">
<h3><span class="header-section-number">9.6.3</span> SPSS, STATA, SAS</h3>
<p>A su vez, también R facilmente permite la comunicación con otros softwares estadísticos, o programas destinados al manejo de bases de datos. La librería <em>haven</em> tiene funciones que permiten leer archivos que provienen de otros programas como <strong>SPSS</strong>, <strong>STATA</strong> y <strong>SAS</strong>, entre otros. Los comandos son:</p>
<ul>
<li>read_spss()</li>
<li>read_dta()</li>
<li>read_sas()</li>
</ul>
</div>
<div id="encoding" class="section level3">
<h3><span class="header-section-number">9.6.4</span> Encoding</h3>
<p>Tanto a la hora de leer y escribir archivos, como al trabajar un mismo script desde distintas computadoras, debemos ser cuidadosos con el <em>encoding</em> seteado. El <em>encoding</em> es el sistema mediante el cual el sistema interpreta los caracteres del lenguaje natural. Hay muchos <em>encodings</em> diferentes, que interpretan distinto algunos caracteres, como tildes y signos de puntuación.<br />
Por ende, si el <em>encoding</em> seteado no es el mismo que el de nuestro script/tabla pueden generarse errores. En medida de lo posible, al escribir nuestros scripts es recomendable evitar estos caracteres.</p>
<p>R tiene por default el encoding <strong>“ISO-8859-1”</strong>, sin embargo el más habitual en América Latina es <strong>“UTF-8”</strong>.</p>
<ul>
<li><strong>Lectura de archivos</strong> : Aglunas de las funciones del tipo <strong>read_table</strong>, <strong>read.xlsx</strong> permiten establecer como uno de sus parametros el <em>encoding</em> deseado</li>
<li><strong>Encoding utilizado para abrir un script</strong>:File -&gt; Reopen with Encoding</li>
<li><strong>Encoding default con el que se guardan nuestros Scripts</strong>: Tools -&gt; Global Options -&gt; Code -&gt; Saving
## Organización scripts</li>
</ul>
<p>Por último, es aconsejable mantener en todos los script una misma estructura del tipo:</p>
<ol style="list-style-type: decimal">
<li>Limpiar la memoria <code>rm(list=ls())</code><br />
</li>
<li>Cargar librerías</li>
<li>Definir funciones</li>
<li>Levantar archivos<br />
… procesamiento ….<br />
</li>
</ol>
<ol start="14" style="list-style-type: lower-alpha">
<li>grabar resultados</li>
</ol>
<p>También es útil organizar las partes del script en capítulos. Para eso</p>
<p><code>### escribimos el título del capitulo encerrado entre tres o más numerales ###</code></p>
</div>
</div>
<div id="ayudas" class="section level2">
<h2><span class="header-section-number">9.7</span> Ayudas</h2>
<p>Hay muchas ayudas, propias del programa, o de usuarios, que pueden ser de ayuda.</p>
<ul>
<li><p>En el programa, para consultar los parámetros de una función, le escribe <code>?funcion()</code></p></li>
<li><p><a href="https://www.rstudio.com/resources/cheatsheets/">Rstudio</a> tiene unos machetes muy útiles</p></li>
<li><p><a href="https://www.rdocumentation.org/">Rdocumentation</a></p></li>
<li><p><a href="https://stackoverflow.com/questions/tagged/r">stack overflow</a> conviene llegar desde google</p></li>
</ul>
<p>La <em>clave</em> es aprender la terminología para googlear en ingles las dudas, y prestar atención a que las respuestas sean actuales (R es un lenguaje <em>vivo</em>)</p>
</div>
<div id="ejercicios-para-practicar-2" class="section level2">
<h2><span class="header-section-number">9.8</span> Ejercicios para practicar</h2>
<ul>
<li>Crear una <strong>función</strong> llamada <em>HolaMundo</em> que imprima el texto “Hola mundo”</li>
<li><p>Crear una <strong>función</strong> que devuelva la sumatoria de los números enteros comprendidos entre 1 y un parámetro <em>x</em> a definir.</p></li>
<li>Crear una <strong>función</strong> que calcule la frecuencia expandida por un PONDERA</li>
<li><p>Utilizar dicha función para calcular la frecuencia poblaciónal por Sexo y Región</p></li>
<li>Modificar la función anterior para que devuelva un vector con la frecuencia muestra <strong>y</strong> la frecuencia poblacional</li>
<li><p>Utilizar la función modificada para calcular la frecuencias frecuencias muestrales y poblacionales por Sexo y Región</p></li>
<li>Levantar la base Individual del 1er trimestre de 2017, de la EPH</li>
<li>Guardar la base Individual del 1er trimestre de 2017 como un archivo de extensión .RDS</li>
<li><p>Volver a levantar la base, pero como .RDS y asignarla con el nombre <em>BaseRDS</em> ¿tarda más o menos?</p></li>
</ul>

</div>
</div>








<div class="footnotes">
<hr />
<ol start="3">
<li id="fn3"><p>basado en <a href="https://jennybc.github.io/purrr-tutorial/ls03_map-function-syntax.html" class="uri">https://jennybc.github.io/purrr-tutorial/ls03_map-function-syntax.html</a><a href="programacion-funcional.html#fnref3" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rmarkdown.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
